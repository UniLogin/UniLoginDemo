<html>

<head>
    <title>Universal Login Provider demo</title>
    <script src="https://unpkg.com/web3@latest/dist/web3.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <button id="unilogin-button"></button>
    <script src="https://unpkg.com/@unilogin/provider"></script>
    <script>
        window.web3 = new Web3(ULIFrameProvider.create('kovan'))
    </script>
    </br></br><input id='address' type='text' maxlength='42' style='width: 26em' placeholder='Receiver address'></input></br>
    <button style='width: 26em;' onclick='web3.eth.requestAccounts().then(accounts => web3.eth.sendTransaction({from: accounts[0], to: document.getElementById("address").value, value: 10000000000000000}))'>
        Send 0.01 ETH
    </button>
    </br>
    <button style='width: 26em;' onclick='web3.eth.requestAccounts().then(accounts => {
        const count = web3.eth.getTransactionCount(accounts[0]);
        const abiArray = JSON.parse(fs.readFileSync("dai.json", "utf-8"));
        const contractAddress = document.getElementById("address").value;
        const contract = web3.eth.contract(abiArray).at(contractAddress);
        const rawTransaction = {
            "from": accounts[0],
            "nonce": web3.toHex(count),
            "gasPrice": accounts[0].gasPrice,
            "gasLimit": accounts[0].gasLimit,
            "to": contractAddress,
            "value": "0x1",
            "data": accounts[0].data,
            "chainId": 0x03
        };

        const privKey = accounts[0].privKey;
        const tx = new Tx(rawTransaction);

        tx.sign(privKey);
        const serializedTx = tx.serialize();

        web3.eth.sendRawTransaction("0x" + serializedTx.toString("hex"), function(err, hash) {
            if (!err)
                console.log("Sent 1 DAI");
            else
                console.log(err);
        });
        })'>
        Send 1 DAI
    </button>
</body>

</html>
